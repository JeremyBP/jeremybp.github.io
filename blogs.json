{"status":"ok","feed":{"url":"https://medium.com/feed/@jeremybp","title":"Stories by JeremyBP on Medium","link":"https://medium.com/@jeremybp?source=rss-278157eec3f4------2","author":"","description":"Stories by JeremyBP on Medium","image":"https://cdn-images-1.medium.com/fit/c/150/150/1*XrGw4sRAf7z_iB9N39MGUg.png"},"items":[{"title":"StarCellar E02: Adjusting basics with Apizr","pubDate":"2024-12-06 09:40:42","link":"https://medium.com/@jeremybp/starcellar-e02-adjusting-basics-with-apizr-02069fc8c3c5?source=rss-278157eec3f4------2","guid":"https://medium.com/p/02069fc8c3c5","author":"JeremyBP","thumbnail":"","description":"\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/600/0*Wcov7CtFG9qtjfOA.gif\"></figure><p>Episode 02 of an Apizr walkthrough building a MAUI app requesting a backend\u00a0API.</p>\n<p>Apizr is a Refit based web api client manager, but resilient (retry, connectivity, cache, auth, log, priority, etc\u2026).</p>\n<p>This episode is about adjusting some basic\u00a0options.</p>\n<h3>Apizr</h3>\n<p>If you\u2019re new to Apizr, you shoud know that it\u2019s based on Refit and aims to provide many more features on top of it, like retry handling, connectivity check, cache management, authentication handling, priority management, and so on\u2026 It\u2019s here to help me to don\u2019t repeat myself into each and every projects while dealing with api request calls and resilience needs.</p>\n<p>Get the big picture by reading the documentation:</p>\n<figure><a href=\"https://apizr.net/\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/196/0*9ppc8kuIeu5hLrFV\"></a></figure><p>Feel free to browse code, tests and samples and maybe to submit PRs or\u00a0ideas:</p>\n<figure><a href=\"https://github.com/Respawnsive/Apizr\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/192/0*fOswmWd5yM_5k8wd\"></a></figure><p>Don\u2019t forget the YouTube Channel Playlist about\u00a0Apizr:</p>\n<figure><a href=\"https://www.youtube.com/playlist?list=PLP7ES6CZYy_3zYjmOJzi3K_GZlViorgUO\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/106/0*lg2Wn2DgN15jDppN\"></a></figure><h3>The starcellar series</h3>\n<p>The StarCellar walkthrough series is built thanks to multiple episodes, each with a dedicated source code branch, blog post and playlist\u00a0video.</p>\n<p>Feel free to fork the project and start from the main branch, so that you could follow this tutorial coding by yourself. If you do so, don\u2019t forget to run the API through a Dev Tunnel and to update the MAUI app\u2019s base\u00a0address.</p>\n<a href=\"https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href\">https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href</a><h3>The starcellar episode\u00a002</h3>\n<p>The current episode is covered by this\u00a0video:</p>\n<a href=\"https://medium.com/media/27ff9aa3ab65b76a2280db0121234995/href\">https://medium.com/media/27ff9aa3ab65b76a2280db0121234995/href</a><h4>Adjusting basic options Without\u00a0Apizr</h4>\n<p>First, the <strong>Without.Apizr</strong> project!</p>\n<p>I\u2019ll try to set the base address, not from any constant value but loaded from an appsettings.json file.</p>\n<p>Start by referencing some NuGet packages:</p>\n<ul>\n<li><strong>Microsoft.Extensions.Configuration.Binder</strong></li>\n<li><strong>Microsoft.Extensions.Configuration.Json</strong></li>\n<li><strong>Microsoft.Extensions.FileProviders.Embedded</strong></li>\n</ul>\n<p>Now add a json file and set it to EmbeddedResource (needed by MAUI but not for any other project\u00a0type).</p>\n<p>Then write something like this into\u00a0it:</p>\n<pre>{<br>  \"AppSettings\": {<br>    \"BaseAddress\": \"https://YOUR_BASE_ADDRESS\"<br>  }<br>}</pre>\n<p>Now create an <strong>AppSettings</strong> class file looking\u00a0like:</p>\n<pre>public class AppSettings<br>{<br>    public string BaseAddress { get; set; }<br>}</pre>\n<p>Then open the MauiProgram class and scroll to the Refit registration part.</p>\n<p>There, replace\u00a0all:</p>\n<pre>.ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress));</pre>\n<p>by:</p>\n<pre>.ConfigureHttpClient((sp, c) =&gt; c.BaseAddress = new Uri(sp.GetRequiredService&lt;IConfiguration&gt;()<br>    .GetRequiredSection(\"AppSettings\").Get&lt;AppSettings&gt;().BaseAddress));</pre>\n<p>Here we set the base address from our appsettings instead of former constant.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Adjusting basic options With\u00a0Apizr</h4>\n<p>Now the <strong>With.Apizr</strong> project!</p>\n<p>Repeat the exact same steps you did previously without Apizr but the MauiProgram\u2019s registration part.</p>\n<p>Insert into both ICellarApi and IFileApi registrations the following builder parameter:</p>\n<pre>options =&gt; options.ConfigureHttpClientBuilder(<br>    httpClientBuilder =&gt; httpClientBuilder.ConfigureHttpClient(<br>        (sp, c) =&gt; c.BaseAddress = new Uri(sp.GetRequiredService&lt;IConfiguration&gt;()<br>            .GetRequiredSection(\"AppSettings\")<br>            .Get&lt;AppSettings&gt;()<br>            .BaseAddress)))</pre>\n<p>Here we set the base address fluently from our appsettings, instead of former constant previously set by attribute design.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Sharing common options With Apizr\u00a0registry</h4>\n<p>I don\u2019t like to repeat myself while coding,\u00a0really!</p>\n<p>So when it came to Apizr, I managed to let it offer a way to share some common options between multiple\u00a0apis.</p>\n<p>That\u2019s where the registry comes\u00a0in.</p>\n<p>Instead of repeating registrations despite the same options, replace it all\u00a0by:</p>\n<pre>builder.Services.AddApizr(<br>    registry =&gt; registry<br>        .AddManagerFor&lt;ICellarApi&gt;()<br>        .AddManagerFor&lt;IFileApi&gt;(),<br><br>    options =&gt; options<br>        .WithBaseAddress(sp =&gt; sp.GetRequiredService&lt;IConfiguration&gt;()<br>        .GetRequiredSection(\"AppSettings\")<br>        .Get&lt;AppSettings&gt;()<br>        .BaseAddress));</pre>\n<p>There, you can see that we added our cellar and file apis to the Apizr registry, then we provided a base address to be set to both of\u00a0it.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Sharing more options With\u00a0Apizr</h4>\n<p>Previously, we shared options between different apis.</p>\n<p>But we can share options between different requests of a single api\u00a0too.</p>\n<p>If you look at the ICellarApi interface, you\u2019ll find some kind of duplicated code, the \u201c/wines\u201d\u00a0path:</p>\n<pre>public interface ICellarApi<br>{<br>    [Get(\"/wines\")]<br>    Task&lt;IEnumerable&lt;Wine&gt;&gt; GetWinesAsync();<br><br>    [Get(\"/wines/{id}\")]<br>    Task&lt;Wine&gt; GetWineDetailsAsync(Guid id);<br><br>    [Post(\"/wines\")]<br>    Task&lt;Wine&gt; CreateWineAsync(Wine item);<br><br>    [Put(\"/wines/{id}\")]<br>    Task UpdateWineAsync(Guid id, Wine item);<br><br>    [Delete(\"/wines/{id}\")]<br>    Task DeleteWineAsync(Guid id);<br>}</pre>\n<p>There, we could adjust attributes like\u00a0so:</p>\n<pre>[BaseAddress(\"/wines\")]<br>public interface ICellarApi<br>{<br>    [Get(\"\")]<br>    Task&lt;IEnumerable&lt;Wine&gt;&gt; GetWinesAsync();<br><br>    [Get(\"/{id}\")]<br>    Task&lt;Wine&gt; GetWineDetailsAsync(Guid id);<br><br>    [Post(\"\")]<br>    Task&lt;Wine&gt; CreateWineAsync(Wine item);<br><br>    [Put(\"/{id}\")]<br>    Task UpdateWineAsync(Guid id, Wine item);<br><br>    [Delete(\"/{id}\")]<br>    Task DeleteWineAsync(Guid id);<br>}</pre>\n<p>Here the common \u201c/wines\u201d path is shared at interface level to be set to all its requests.</p>\n<p>Apizr will merge the base address with that common path, then with the request\u00a0one.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<p>Note that it could be done by fluent configuration instead of attribute.</p>\n<p>In such scenario, we would just remove the base address attribute from our latest design and adjust the registration like:</p>\n<pre>builder.Services.AddApizr(<br>    registry =&gt; registry<br>        .AddManagerFor&lt;ICellarApi&gt;(options =&gt; options.WithBasePath(\"/wines\"))<br>        .AddManagerFor&lt;IFileApi&gt;(),<br><br>    options =&gt; options<br>        .WithBaseAddress(sp =&gt; sp.GetRequiredService&lt;IConfiguration&gt;()<br>        .GetRequiredSection(\"AppSettings\")<br>        .Get&lt;AppSettings&gt;()<br>        .BaseAddress));</pre>\n<p>Two ways to do the same thing, depending on your\u00a0needs.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Running the\u00a0app</h4>\n<p>Nothing\u2019s changed on the user experience point of view. The same app, but with some options adjusted and shared thanks to\u00a0Apizr:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/411/0*yI9ptdm-i0NXUvlx.gif\"></figure><h3>Get more of\u00a0it</h3>\n<p>Feel free to ask me anything on twitter, or opening a discussion, issue or PR on\u00a0GitHub.</p>\n<p>Again, it\u2019s basically all built for my own use and motivated by my needs. But it\u2019s live on Nuget and opened to all so feel free to contribute.</p>\n<p>Apizr brings many more features so you should head to the next episode to continue your walkthrough path.</p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=02069fc8c3c5\" width=\"1\" height=\"1\" alt=\"\">\n","content":"\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/600/0*Wcov7CtFG9qtjfOA.gif\"></figure><p>Episode 02 of an Apizr walkthrough building a MAUI app requesting a backend\u00a0API.</p>\n<p>Apizr is a Refit based web api client manager, but resilient (retry, connectivity, cache, auth, log, priority, etc\u2026).</p>\n<p>This episode is about adjusting some basic\u00a0options.</p>\n<h3>Apizr</h3>\n<p>If you\u2019re new to Apizr, you shoud know that it\u2019s based on Refit and aims to provide many more features on top of it, like retry handling, connectivity check, cache management, authentication handling, priority management, and so on\u2026 It\u2019s here to help me to don\u2019t repeat myself into each and every projects while dealing with api request calls and resilience needs.</p>\n<p>Get the big picture by reading the documentation:</p>\n<figure><a href=\"https://apizr.net/\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/196/0*9ppc8kuIeu5hLrFV\"></a></figure><p>Feel free to browse code, tests and samples and maybe to submit PRs or\u00a0ideas:</p>\n<figure><a href=\"https://github.com/Respawnsive/Apizr\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/192/0*fOswmWd5yM_5k8wd\"></a></figure><p>Don\u2019t forget the YouTube Channel Playlist about\u00a0Apizr:</p>\n<figure><a href=\"https://www.youtube.com/playlist?list=PLP7ES6CZYy_3zYjmOJzi3K_GZlViorgUO\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/106/0*lg2Wn2DgN15jDppN\"></a></figure><h3>The starcellar series</h3>\n<p>The StarCellar walkthrough series is built thanks to multiple episodes, each with a dedicated source code branch, blog post and playlist\u00a0video.</p>\n<p>Feel free to fork the project and start from the main branch, so that you could follow this tutorial coding by yourself. If you do so, don\u2019t forget to run the API through a Dev Tunnel and to update the MAUI app\u2019s base\u00a0address.</p>\n<a href=\"https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href\">https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href</a><h3>The starcellar episode\u00a002</h3>\n<p>The current episode is covered by this\u00a0video:</p>\n<a href=\"https://medium.com/media/27ff9aa3ab65b76a2280db0121234995/href\">https://medium.com/media/27ff9aa3ab65b76a2280db0121234995/href</a><h4>Adjusting basic options Without\u00a0Apizr</h4>\n<p>First, the <strong>Without.Apizr</strong> project!</p>\n<p>I\u2019ll try to set the base address, not from any constant value but loaded from an appsettings.json file.</p>\n<p>Start by referencing some NuGet packages:</p>\n<ul>\n<li><strong>Microsoft.Extensions.Configuration.Binder</strong></li>\n<li><strong>Microsoft.Extensions.Configuration.Json</strong></li>\n<li><strong>Microsoft.Extensions.FileProviders.Embedded</strong></li>\n</ul>\n<p>Now add a json file and set it to EmbeddedResource (needed by MAUI but not for any other project\u00a0type).</p>\n<p>Then write something like this into\u00a0it:</p>\n<pre>{<br>  \"AppSettings\": {<br>    \"BaseAddress\": \"https://YOUR_BASE_ADDRESS\"<br>  }<br>}</pre>\n<p>Now create an <strong>AppSettings</strong> class file looking\u00a0like:</p>\n<pre>public class AppSettings<br>{<br>    public string BaseAddress { get; set; }<br>}</pre>\n<p>Then open the MauiProgram class and scroll to the Refit registration part.</p>\n<p>There, replace\u00a0all:</p>\n<pre>.ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress));</pre>\n<p>by:</p>\n<pre>.ConfigureHttpClient((sp, c) =&gt; c.BaseAddress = new Uri(sp.GetRequiredService&lt;IConfiguration&gt;()<br>    .GetRequiredSection(\"AppSettings\").Get&lt;AppSettings&gt;().BaseAddress));</pre>\n<p>Here we set the base address from our appsettings instead of former constant.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Adjusting basic options With\u00a0Apizr</h4>\n<p>Now the <strong>With.Apizr</strong> project!</p>\n<p>Repeat the exact same steps you did previously without Apizr but the MauiProgram\u2019s registration part.</p>\n<p>Insert into both ICellarApi and IFileApi registrations the following builder parameter:</p>\n<pre>options =&gt; options.ConfigureHttpClientBuilder(<br>    httpClientBuilder =&gt; httpClientBuilder.ConfigureHttpClient(<br>        (sp, c) =&gt; c.BaseAddress = new Uri(sp.GetRequiredService&lt;IConfiguration&gt;()<br>            .GetRequiredSection(\"AppSettings\")<br>            .Get&lt;AppSettings&gt;()<br>            .BaseAddress)))</pre>\n<p>Here we set the base address fluently from our appsettings, instead of former constant previously set by attribute design.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Sharing common options With Apizr\u00a0registry</h4>\n<p>I don\u2019t like to repeat myself while coding,\u00a0really!</p>\n<p>So when it came to Apizr, I managed to let it offer a way to share some common options between multiple\u00a0apis.</p>\n<p>That\u2019s where the registry comes\u00a0in.</p>\n<p>Instead of repeating registrations despite the same options, replace it all\u00a0by:</p>\n<pre>builder.Services.AddApizr(<br>    registry =&gt; registry<br>        .AddManagerFor&lt;ICellarApi&gt;()<br>        .AddManagerFor&lt;IFileApi&gt;(),<br><br>    options =&gt; options<br>        .WithBaseAddress(sp =&gt; sp.GetRequiredService&lt;IConfiguration&gt;()<br>        .GetRequiredSection(\"AppSettings\")<br>        .Get&lt;AppSettings&gt;()<br>        .BaseAddress));</pre>\n<p>There, you can see that we added our cellar and file apis to the Apizr registry, then we provided a base address to be set to both of\u00a0it.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Sharing more options With\u00a0Apizr</h4>\n<p>Previously, we shared options between different apis.</p>\n<p>But we can share options between different requests of a single api\u00a0too.</p>\n<p>If you look at the ICellarApi interface, you\u2019ll find some kind of duplicated code, the \u201c/wines\u201d\u00a0path:</p>\n<pre>public interface ICellarApi<br>{<br>    [Get(\"/wines\")]<br>    Task&lt;IEnumerable&lt;Wine&gt;&gt; GetWinesAsync();<br><br>    [Get(\"/wines/{id}\")]<br>    Task&lt;Wine&gt; GetWineDetailsAsync(Guid id);<br><br>    [Post(\"/wines\")]<br>    Task&lt;Wine&gt; CreateWineAsync(Wine item);<br><br>    [Put(\"/wines/{id}\")]<br>    Task UpdateWineAsync(Guid id, Wine item);<br><br>    [Delete(\"/wines/{id}\")]<br>    Task DeleteWineAsync(Guid id);<br>}</pre>\n<p>There, we could adjust attributes like\u00a0so:</p>\n<pre>[BaseAddress(\"/wines\")]<br>public interface ICellarApi<br>{<br>    [Get(\"\")]<br>    Task&lt;IEnumerable&lt;Wine&gt;&gt; GetWinesAsync();<br><br>    [Get(\"/{id}\")]<br>    Task&lt;Wine&gt; GetWineDetailsAsync(Guid id);<br><br>    [Post(\"\")]<br>    Task&lt;Wine&gt; CreateWineAsync(Wine item);<br><br>    [Put(\"/{id}\")]<br>    Task UpdateWineAsync(Guid id, Wine item);<br><br>    [Delete(\"/{id}\")]<br>    Task DeleteWineAsync(Guid id);<br>}</pre>\n<p>Here the common \u201c/wines\u201d path is shared at interface level to be set to all its requests.</p>\n<p>Apizr will merge the base address with that common path, then with the request\u00a0one.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<p>Note that it could be done by fluent configuration instead of attribute.</p>\n<p>In such scenario, we would just remove the base address attribute from our latest design and adjust the registration like:</p>\n<pre>builder.Services.AddApizr(<br>    registry =&gt; registry<br>        .AddManagerFor&lt;ICellarApi&gt;(options =&gt; options.WithBasePath(\"/wines\"))<br>        .AddManagerFor&lt;IFileApi&gt;(),<br><br>    options =&gt; options<br>        .WithBaseAddress(sp =&gt; sp.GetRequiredService&lt;IConfiguration&gt;()<br>        .GetRequiredSection(\"AppSettings\")<br>        .Get&lt;AppSettings&gt;()<br>        .BaseAddress));</pre>\n<p>Two ways to do the same thing, depending on your\u00a0needs.</p>\n<p>You can run the app and see that everything\u2019s still\u00a0ok.</p>\n<h4>Running the\u00a0app</h4>\n<p>Nothing\u2019s changed on the user experience point of view. The same app, but with some options adjusted and shared thanks to\u00a0Apizr:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/411/0*yI9ptdm-i0NXUvlx.gif\"></figure><h3>Get more of\u00a0it</h3>\n<p>Feel free to ask me anything on twitter, or opening a discussion, issue or PR on\u00a0GitHub.</p>\n<p>Again, it\u2019s basically all built for my own use and motivated by my needs. But it\u2019s live on Nuget and opened to all so feel free to contribute.</p>\n<p>Apizr brings many more features so you should head to the next episode to continue your walkthrough path.</p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=02069fc8c3c5\" width=\"1\" height=\"1\" alt=\"\">\n","enclosure":{},"categories":["rest-api","refit","dotnet","apizr"]},{"title":"StarCellar E01: Getting Started with Apizr","pubDate":"2024-12-03 11:01:31","link":"https://medium.com/@jeremybp/starcellar-e01-getting-started-with-apizr-47509b9f3876?source=rss-278157eec3f4------2","guid":"https://medium.com/p/47509b9f3876","author":"JeremyBP","thumbnail":"","description":"\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/600/0*1AbNK8TpxUMiDAGm.gif\"></figure><p>4 years and counting between Apizr v1 and its latest\u00a0v6.4.</p>\n<p>This resilient Refit manager has been developped and maintained for my own needs, but open sourced and published on NuGet for free from the begining.</p>\n<p>That said, I did not took the time to show how to use each and every features of it, so that\u2019s what I\u2019m trying to do now by creating this\u00a0series.</p>\n<p>I\u2019ll build a MAUI sample app called StarCellar to manage a wine cellar (I\u2019m french after all \ud83d\ude42 ), both with and without Apizr to show what\u2019s different while requesting a minimal\u00a0API.</p>\n<p>So let\u2019s get\u00a0started!</p>\n<h4>Apizr</h4>\n<p>If you\u2019re new to Apizr, you shoud know that it\u2019s based on Refit and aims to provide many more features on top of it, like retry handling, connectivity check, cache management, authentication handling, priority management, and so on\u2026 It\u2019s here to help me to don\u2019t repeat myself into each and every projects while dealing with api request calls and resilience needs.</p>\n<p>Get the big picture by reading the documentation:</p>\n<figure><a href=\"https://apizr.net/\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/196/0*9ppc8kuIeu5hLrFV\"></a></figure><p>Feel free to browse code, tests and samples and maybe to submit PRs or\u00a0ideas:</p>\n<figure><a href=\"https://github.com/Respawnsive/Apizr\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/192/0*fOswmWd5yM_5k8wd\"></a></figure><p>Don\u2019t forget the YouTube Channel Playlist about\u00a0Apizr:</p>\n<figure><a href=\"https://www.youtube.com/playlist?list=PLP7ES6CZYy_3zYjmOJzi3K_GZlViorgUO\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/106/0*lg2Wn2DgN15jDppN\"></a></figure><h4>The starcellar series</h4>\n<p>The StarCellar walkthrough series is built thanks to multiple episodes, each with a dedicated source code branch, blog post and playlist\u00a0video.</p>\n<p>Feel free to fork the project and start from the main branch, so that you could follow this tutorial coding by yourself. If you do so, don\u2019t forget to run the API through a Dev Tunnel and to update the MAUI app\u2019s base\u00a0address.</p>\n<a href=\"https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href\">https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href</a><h4>The starcellar episode\u00a001</h4>\n<p>The current episode is covered by this\u00a0video:</p>\n<a href=\"https://medium.com/media/a06be133958ee4f9126a7fce216976f9/href\">https://medium.com/media/a06be133958ee4f9126a7fce216976f9/href</a><h4><strong>The application</strong></h4>\n<p>Like I said, there\u2019s a minimal backend API project and 2 MAUI projects:</p>\n<ul>\n<li>\n<strong>StarCellar.Api:</strong> Minimal backend API offering wine bottle CRUDing, file management and authentication</li>\n<li>\n<strong>StarCellar.Without.Apizr:</strong> MAUI app to manage the cellar without using Apizr but Refit with 3rd part\u00a0libs</li>\n<li>\n<strong>StarCellar.With.Apizr:</strong> MAUI app to manage the cellar by using Apizr with integrated libs</li>\n</ul>\n<p>The MAUI app is quite simple with features\u00a0like:</p>\n<ul>\n<li>Show all wines from the cellar in a list\u00a0view</li>\n<li>Show more infos about the selected wine in a details\u00a0view</li>\n<li>Change wine infos in a edit view (image, title, description and\u00a0score)</li>\n<li>Add a new wine to the cellar in the edit\u00a0view</li>\n</ul>\n<p>For this Getting Started episode, both <em>With</em> and <em>Without</em> projects are yet configured and functional with just Refit in place, so I\u2019ll work on the <em>With</em> project\u00a0only.</p>\n<h4>Installing apizr</h4>\n<p>Start by removing the <strong>Refit</strong> package from the <em>With</em> project and install the <strong>Apizr.Extensions.Microsoft.DependencyInjection</strong> one\u00a0instead.</p>\n<p>Setting base address by attribute</p>\n<p>Open the <strong>ICellarApi </strong>interface from <em>Services &gt; Apis &gt; Cellar</em>\u00a0folder.</p>\n<p>Add a <strong>BaseAddress </strong>attribute over the interface with <strong>Constants.BaseAddress</strong> as parameter.</p>\n<p>Repeat the operation with the <strong>IFileApi</strong>.</p>\n<h4>Registering Apizr</h4>\n<p>Into <strong>MauiProgram</strong><em>:</em></p>\n<ul><li>Replace folowing former <strong>Refit</strong> registration block:</li></ul>\n<pre>builder.Services.AddRefitClient&lt;ICellarApi&gt;() <br>    .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress)); <br><br>builder.Services.AddRefitClient&lt;IFileApi&gt;() <br>    .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress));</pre>\n<p>by the <strong>Apizr</strong>\u00a0one:</p>\n<pre>builder.Services.AddApizrManagerFor&lt;ICellarApi&gt;();<br>builder.Services.AddApizrManagerFor&lt;IFileApi&gt;();</pre>\n<p><strong>Using Apizr managers from ViewModels</strong></p>\n<p>Now the managers are registered, let\u2019s use it from our ViewModels.</p>\n<p>Open all ViewModels from <em>ViewModels </em>folder.</p>\n<p>Inject <strong>IApizrManager&lt;ICellarApi&gt; _cellarApiManager</strong> instead of <strong>ICellarApi _cellarApi</strong> into all ViewModel\u2019s constructors.</p>\n<p>Now use the managed\u00a0api!</p>\n<ul><li>Replace call:</li></ul>\n<pre>_cellarApi.GetWinesAsync();</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.GetWinesAsync());</pre>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_cellarApi.DeleteWineAsync(Wine.Id);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.DeleteWineAsync(Wine.Id));</pre>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_cellarApi.CreateWineAsync(Wine);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.CreateWineAsync(Wine));</pre>\n<ul><li>Finaly replace\u00a0call:</li></ul>\n<pre>_cellarApi.UpdateWineAsync(Wine.Id, Wine);</pre>\n<p>by the managed\u00a0on:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.UpdateWineAsync(Wine.Id, Wine));</pre>\n<p>We also have to manage the file api, so inject <strong>IApizrManager&lt;IFileApi&gt; _fileApiManager</strong> instead of <strong>IFileApi _fileApi</strong> into WineEditViewModel\u2019s constructor.</p>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_fileApi.UploadAsync(streamPart);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_fileApiManager.ExecuteAsync(api =&gt; api.UploadAsync(streamPart));</pre>\n<p>And we\u2019re\u00a0good!</p>\n<p>All calls will be managed by Apizr, so here in this example, Apizr will set the base address by\u00a0design.</p>\n<h4>Running the\u00a0app</h4>\n<p>Nothing\u2019s changed on the user experience point of view. The same app, but with requests managed by\u00a0Apizr:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/411/0*eehffyYnO0-qBTdD.gif\"></figure><h4>Get more of\u00a0it</h4>\n<p>Feel free to ask me anything on twitter, or opening a discussion, issue or PR on\u00a0GitHub.</p>\n<p>Again, it\u2019s basically all built for my own use and motivated by my needs. But it\u2019s live on Nuget and opened to all so feel free to contribute.</p>\n<p>Apizr brings many more features so you should head to the next episode to continue your walkthrough path.</p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=47509b9f3876\" width=\"1\" height=\"1\" alt=\"\">\n","content":"\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/600/0*1AbNK8TpxUMiDAGm.gif\"></figure><p>4 years and counting between Apizr v1 and its latest\u00a0v6.4.</p>\n<p>This resilient Refit manager has been developped and maintained for my own needs, but open sourced and published on NuGet for free from the begining.</p>\n<p>That said, I did not took the time to show how to use each and every features of it, so that\u2019s what I\u2019m trying to do now by creating this\u00a0series.</p>\n<p>I\u2019ll build a MAUI sample app called StarCellar to manage a wine cellar (I\u2019m french after all \ud83d\ude42 ), both with and without Apizr to show what\u2019s different while requesting a minimal\u00a0API.</p>\n<p>So let\u2019s get\u00a0started!</p>\n<h4>Apizr</h4>\n<p>If you\u2019re new to Apizr, you shoud know that it\u2019s based on Refit and aims to provide many more features on top of it, like retry handling, connectivity check, cache management, authentication handling, priority management, and so on\u2026 It\u2019s here to help me to don\u2019t repeat myself into each and every projects while dealing with api request calls and resilience needs.</p>\n<p>Get the big picture by reading the documentation:</p>\n<figure><a href=\"https://apizr.net/\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/196/0*9ppc8kuIeu5hLrFV\"></a></figure><p>Feel free to browse code, tests and samples and maybe to submit PRs or\u00a0ideas:</p>\n<figure><a href=\"https://github.com/Respawnsive/Apizr\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/192/0*fOswmWd5yM_5k8wd\"></a></figure><p>Don\u2019t forget the YouTube Channel Playlist about\u00a0Apizr:</p>\n<figure><a href=\"https://www.youtube.com/playlist?list=PLP7ES6CZYy_3zYjmOJzi3K_GZlViorgUO\"><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/106/0*lg2Wn2DgN15jDppN\"></a></figure><h4>The starcellar series</h4>\n<p>The StarCellar walkthrough series is built thanks to multiple episodes, each with a dedicated source code branch, blog post and playlist\u00a0video.</p>\n<p>Feel free to fork the project and start from the main branch, so that you could follow this tutorial coding by yourself. If you do so, don\u2019t forget to run the API through a Dev Tunnel and to update the MAUI app\u2019s base\u00a0address.</p>\n<a href=\"https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href\">https://medium.com/media/e78f4b37dcfc41431aabf279678c44cf/href</a><h4>The starcellar episode\u00a001</h4>\n<p>The current episode is covered by this\u00a0video:</p>\n<a href=\"https://medium.com/media/a06be133958ee4f9126a7fce216976f9/href\">https://medium.com/media/a06be133958ee4f9126a7fce216976f9/href</a><h4><strong>The application</strong></h4>\n<p>Like I said, there\u2019s a minimal backend API project and 2 MAUI projects:</p>\n<ul>\n<li>\n<strong>StarCellar.Api:</strong> Minimal backend API offering wine bottle CRUDing, file management and authentication</li>\n<li>\n<strong>StarCellar.Without.Apizr:</strong> MAUI app to manage the cellar without using Apizr but Refit with 3rd part\u00a0libs</li>\n<li>\n<strong>StarCellar.With.Apizr:</strong> MAUI app to manage the cellar by using Apizr with integrated libs</li>\n</ul>\n<p>The MAUI app is quite simple with features\u00a0like:</p>\n<ul>\n<li>Show all wines from the cellar in a list\u00a0view</li>\n<li>Show more infos about the selected wine in a details\u00a0view</li>\n<li>Change wine infos in a edit view (image, title, description and\u00a0score)</li>\n<li>Add a new wine to the cellar in the edit\u00a0view</li>\n</ul>\n<p>For this Getting Started episode, both <em>With</em> and <em>Without</em> projects are yet configured and functional with just Refit in place, so I\u2019ll work on the <em>With</em> project\u00a0only.</p>\n<h4>Installing apizr</h4>\n<p>Start by removing the <strong>Refit</strong> package from the <em>With</em> project and install the <strong>Apizr.Extensions.Microsoft.DependencyInjection</strong> one\u00a0instead.</p>\n<p>Setting base address by attribute</p>\n<p>Open the <strong>ICellarApi </strong>interface from <em>Services &gt; Apis &gt; Cellar</em>\u00a0folder.</p>\n<p>Add a <strong>BaseAddress </strong>attribute over the interface with <strong>Constants.BaseAddress</strong> as parameter.</p>\n<p>Repeat the operation with the <strong>IFileApi</strong>.</p>\n<h4>Registering Apizr</h4>\n<p>Into <strong>MauiProgram</strong><em>:</em></p>\n<ul><li>Replace folowing former <strong>Refit</strong> registration block:</li></ul>\n<pre>builder.Services.AddRefitClient&lt;ICellarApi&gt;() <br>    .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress)); <br><br>builder.Services.AddRefitClient&lt;IFileApi&gt;() <br>    .ConfigureHttpClient(c =&gt; c.BaseAddress = new Uri(Constants.BaseAddress));</pre>\n<p>by the <strong>Apizr</strong>\u00a0one:</p>\n<pre>builder.Services.AddApizrManagerFor&lt;ICellarApi&gt;();<br>builder.Services.AddApizrManagerFor&lt;IFileApi&gt;();</pre>\n<p><strong>Using Apizr managers from ViewModels</strong></p>\n<p>Now the managers are registered, let\u2019s use it from our ViewModels.</p>\n<p>Open all ViewModels from <em>ViewModels </em>folder.</p>\n<p>Inject <strong>IApizrManager&lt;ICellarApi&gt; _cellarApiManager</strong> instead of <strong>ICellarApi _cellarApi</strong> into all ViewModel\u2019s constructors.</p>\n<p>Now use the managed\u00a0api!</p>\n<ul><li>Replace call:</li></ul>\n<pre>_cellarApi.GetWinesAsync();</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.GetWinesAsync());</pre>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_cellarApi.DeleteWineAsync(Wine.Id);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.DeleteWineAsync(Wine.Id));</pre>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_cellarApi.CreateWineAsync(Wine);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.CreateWineAsync(Wine));</pre>\n<ul><li>Finaly replace\u00a0call:</li></ul>\n<pre>_cellarApi.UpdateWineAsync(Wine.Id, Wine);</pre>\n<p>by the managed\u00a0on:</p>\n<pre>_cellarApiManager.ExecuteAsync(api =&gt; api.UpdateWineAsync(Wine.Id, Wine));</pre>\n<p>We also have to manage the file api, so inject <strong>IApizrManager&lt;IFileApi&gt; _fileApiManager</strong> instead of <strong>IFileApi _fileApi</strong> into WineEditViewModel\u2019s constructor.</p>\n<ul><li>Then replace\u00a0call:</li></ul>\n<pre>_fileApi.UploadAsync(streamPart);</pre>\n<p>by the managed\u00a0one:</p>\n<pre>_fileApiManager.ExecuteAsync(api =&gt; api.UploadAsync(streamPart));</pre>\n<p>And we\u2019re\u00a0good!</p>\n<p>All calls will be managed by Apizr, so here in this example, Apizr will set the base address by\u00a0design.</p>\n<h4>Running the\u00a0app</h4>\n<p>Nothing\u2019s changed on the user experience point of view. The same app, but with requests managed by\u00a0Apizr:</p>\n<figure><img alt=\"\" src=\"https://cdn-images-1.medium.com/max/411/0*eehffyYnO0-qBTdD.gif\"></figure><h4>Get more of\u00a0it</h4>\n<p>Feel free to ask me anything on twitter, or opening a discussion, issue or PR on\u00a0GitHub.</p>\n<p>Again, it\u2019s basically all built for my own use and motivated by my needs. But it\u2019s live on Nuget and opened to all so feel free to contribute.</p>\n<p>Apizr brings many more features so you should head to the next episode to continue your walkthrough path.</p>\n<img src=\"https://medium.com/_/stat?event=post.clientViewed&amp;referrerSource=full_rss&amp;postId=47509b9f3876\" width=\"1\" height=\"1\" alt=\"\">\n","enclosure":{},"categories":["refit","apizr","dotnet","rest-api"]}]}